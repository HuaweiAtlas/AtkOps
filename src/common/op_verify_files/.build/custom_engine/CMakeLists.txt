# Copyright (c) Huawei Technologies Co., Ltd. 2017-2018. All rights reserved.
# Description: generated by MindStudio
# Author: Huawei
# Create: 2017-06-06

# CMake lowest version requirement
cmake_minimum_required(VERSION 2.8)

# project information
PROJECT(custom)

# Device: set compiler
SET(CMAKE_C_COMPILER "$ENV{DDK_PATH}/uihost/toolchains/aarch64-linux-gcc6.3/bin/aarch64-linux-gnu-gcc")
SET(CMAKE_CXX_COMPILER "$ENV{DDK_PATH}/uihost/toolchains/aarch64-linux-gcc6.3/bin/aarch64-linux-gnu-g++")
if(target STREQUAL "OI")
    SET(CMAKE_C_COMPILER "aarch64-linux-gnu-gcc")
    SET(CMAKE_CXX_COMPILER "aarch64-linux-gnu-g++")
else()
    SET(CMAKE_C_COMPILER "$ENV{DDK_PATH}/uihost/toolchains/aarch64-linux-gcc6.3/bin/aarch64-linux-gnu-gcc")
    SET(CMAKE_CXX_COMPILER "$ENV{DDK_PATH}/uihost/toolchains/aarch64-linux-gcc6.3/bin/aarch64-linux-gnu-g++")
endif()



# Header path
include_directories(
../../.inc
$ENV{DDK_PATH}/include/inc/
$ENV{DDK_PATH}/include/third_party/cereal/include
$ENV{DDK_PATH}/include/libc_sec/include
$ENV{DDK_PATH}/include/third_party/protobuf/include/
/usr/include/python2.7
)
# Link path

if(DEFINED ENV{NPU_DEVICE_LIB})
    link_directories("$ENV{NPU_DEVICE_LIB}")
else()
    link_directories("$ENV{DDK_PATH}/device/lib/")
endif()

# Compile options
add_compile_options(-std=c++11 -fstack-protector-all -fPIC -Wl,-z,relro,-z,now,-z,noexecstack)


set(CMAKE_BUILD_TYPE "debug")
set(CMAKE_CXX_FLAGS_DEBUG "$ENV{CXXFLAGS} -O0 -Wall -g -ggdb")
set(CMAKE_CXX_FLAGS_RELEASE "$ENV{CXXFLAGS} -O2 -Wall")

# Specify target generation path
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY   "../../out")
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY   "../../out")
SET(CMAKE_INSTALL_PREFIX "../../out")  
# build engine
ADD_LIBRARY(custom_engine  SHARED  ../../.src/custom_common.cpp  ../../.src/custom_engine.cpp ../../common/op_attr.cpp)
