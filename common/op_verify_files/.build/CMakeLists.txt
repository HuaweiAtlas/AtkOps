# Copyright (c) Huawei Technologies Co., Ltd. 2017-2018. All rights reserved.
# Description: generated by MindStudio
# Author: Huawei
# Create: 2017-06-06

# CMake lowest version requirement
cmake_minimum_required(VERSION 2.8)
 
# project information
PROJECT(custom)

# Header path
include_directories(
../.inc
$ENV{DDK_PATH}/include/inc/
$ENV{DDK_PATH}/include/third_party/cereal/include
$ENV{DDK_PATH}/include/libc_sec/include
$ENV{DDK_PATH}/include/third_party/protobuf/include/
/usr/include/python2.7
)
# Link path
 

if(DEFINED ENV{NPU_HOST_LIB})
    link_directories("$ENV{NPU_HOST_LIB}")
else()
    link_directories("$ENV{DDK_PATH}/host/lib/")
endif()  
# Compile options
add_compile_options(-std=c++11 -fstack-protector-all -Wl,-z,relro,-z,now,-z,noexecstack)


set(CMAKE_BUILD_TYPE "debug")
set(CMAKE_CXX_FLAGS_DEBUG "$ENV{CXXFLAGS} -O0 -Wall -g -ggdb")
set(CMAKE_CXX_FLAGS_RELEASE "$ENV{CXXFLAGS} -O2 -Wall")

# Specify target generation path
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY   "../out")
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY   "../out")
SET(CMAKE_INSTALL_PREFIX "../out")  
# Compile engine
ADD_SUBDIRECTORY("custom_engine")
# Set compiler
if(target STREQUAL "OI")
    SET(CMAKE_C_COMPILER "aarch64-linux-gnu-gcc")
    SET(CMAKE_CXX_COMPILER "aarch64-linux-gnu-g++")
else()
    SET(CMAKE_C_COMPILER "/usr/bin/cc")
    SET(CMAKE_CXX_COMPILER "/usr/bin/c++")
endif()


# Specify executable or .so file to be generated 
add_executable(main  ../.src/fpga_main.cpp ../.src/custom_common.cpp ../.src/ioengine.cpp )

# Add link libraries
if(target STREQUAL "OI")
    target_link_libraries(main matrixdaemon drvaicpu aicpu_engine pthread)
else()
    target_link_libraries(main matrix pthread)
endif()

